spring:
  application:
    name: liftupai

  datasource:
    url: jdbc:mysql://localhost:3308/liftupai_db?createDatabaseIfNotExist=true&useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Seoul&characterEncoding=UTF-8
    username: root
    password: ${DB_PASSWORD:yourpassword}  # .env 파일에서 읽거나 기본값 사용
    driver-class-name: com.mysql.cj.jdbc.Driver

  jpa:
    hibernate:
      ddl-auto: update  # Flyway가 모든 스키마 관리
    properties:
      hibernate:
        format_sql: false
        show_sql: false
        dialect: org.hibernate.dialect.MySQL8Dialect
        default_batch_fetch_size: 100
    open-in-view: false

  flyway:
    enabled: true
    baseline-on-migrate: true  # 기존 DB에 Flyway 적용
    baseline-version: 0  # 기존 스키마를 버전 0으로 간주
    locations: classpath:db/migration
    sql-migration-suffixes: .sql
    validate-on-migrate: false  # 순환 참조 방지를 위해 비활성화
    out-of-order: false

  sql:
    init:
      mode: never  # 기존 데이터가 있으면 data.sql 실행 안 함
      data-locations: classpath:data.sql

  jackson:
    property-naming-strategy: SNAKE_CASE
    default-property-inclusion: NON_NULL

server:
  port: 8081
  error:
    include-message: always
    include-binding-errors: always

# JWT 설정
jwt:
  secret: ${JWT_SECRET:mySecretKeyForJWTTokenGenerationAndValidation12345678}  # .env 파일에서 읽거나 기본값 사용
  access-token-expiration: 3600000  # 1시간 (밀리초)
  refresh-token-expiration: 2592000000  # 30일 (밀리초)

# Google Gemini API 설정
gemini:
  api-key: ${GEMINI_API_KEY}
  model: gemini-2.0-flash-lite
  max-tokens: 2048
  temperature: 0.7

# Qdrant Vector DB 설정
qdrant:
  host: ${QDRANT_HOST:localhost}
  port: ${QDRANT_PORT:6334}

# Vector 마이그레이션 설정
vector:
  migration:
    enabled: true  # 프로덕션에서는 false로 설정 권장

# API 설정
api:
  rate-limit:
    requests-per-minute: 100
  cors:
    allowed-origins: http://localhost:3000,http://localhost:5173
    allowed-methods: GET,POST,PUT,DELETE,OPTIONS
    allowed-headers: "*"

# 파일 업로드 설정
spring.servlet.multipart:
  max-file-size: 10MB
  max-request-size: 10MB

# Upload configuration
upload:
  use-s3: true
  dir: uploads
  base-url: http://localhost:8081

# Logging
logging:
  level:
    com.richjun.liftupai: INFO
    org.springframework.web: INFO
    org.hibernate.SQL: INFO
    org.hibernate.type.descriptor.sql: INFO

cloud:
  aws:
    s3:
      bucket: dearglobe
      folder: liftupai/
    region:
      static: ap-northeast-2
    credentials:
      access-key: ${AWS_ACCESS_KEY}
      secret-key: ${AWS_SECRET_KEY}